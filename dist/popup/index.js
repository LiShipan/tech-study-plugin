const e={home:"https://www.xuexi.cn/",examPractice:"https://pc.xuexi.cn/points/exam-practice.html",examPaper:"https://pc.xuexi.cn/points/exam-paper-detail.html"};var t,a,o,i;let n;!function(e){e[e.AUTO_START=0]="AUTO_START",e[e.SCHEDULE_RUN=1]="SCHEDULE_RUN",e[e.VIDEO_MUTED=2]="VIDEO_MUTED",e[e.RANDOM_EXAM=3]="RANDOM_EXAM",e[e.AUTO_ANSWER=4]="AUTO_ANSWER",e[e.REMOTE_PUSH=5]="REMOTE_PUSH"}(t||(t={})),function(e){e[e.LOGIN=0]="LOGIN",e[e.READ=1]="READ",e[e.WATCH=2]="WATCH",e[e.PRACTICE=3]="PRACTICE"}(a||(a={})),function(e){e[e.LOADING=0]="LOADING",e[e.START=1]="START",e[e.PROGRESS=2]="PROGRESS",e[e.PAUSE=3]="PAUSE",e[e.FINISH=4]="FINISH"}(o||(o={})),function(e){e[e.READ=0]="READ",e[e.WATCH=1]="WATCH"}(i||(i={}));const s=new WeakMap,c=new WeakMap,l=e=>{if(!n)return;let t=s.get(e);if(!t){t=new Map;const a=new Set;return a.add(n),t.set("value",a),void s.set(e,t)}let a=t.get("value");if(!a)return a=new Set,a.add(n),t.set("value",a),void s.set(e,t);a.add(n)};function r(e,t,a,o){if(!c.get(e))return;const i=s.get(e);if(!i)return;let n=i.get(t);if(n)for(const e of n)e(a,o)}var u;!function(e){e.IS_REF="_isRef",e.IS_SHALLOW="_isShallow",e.IS_REACTIVE="_isReactive",e.IS_READONLY="_isReadonly"}(u||(u={}));class d{_isShallow=!1;_isRef=!0;_value;value;constructor(e,t=!1){const a=this;if(this._isShallow=t,e&&"object"==typeof e&&t){const t=M(e);this._value=t,this.value=e}else this._value=e,this.value=e;Object.defineProperty(this,"value",{get(){return l(this),a._value},set(e){const t=this._value;t!==e&&(a._value=e,function(e,t,a){const o=s.get(e);if(!o)return;let i=o.get("value");if(i)for(const e of i)e instanceof Function&&e(t,a)}(this,e,t))}})}toJSON(){return this._value}}const v=e=>!(!e||!e[u.IS_REF]),g=(e,t)=>new d(e,t),f=e=>v(e)?e.value:e,h=e=>v(e)?e:g(e,!0),p=e=>v(e)?e:g(e,!1),m=(e,t)=>function(a,o,i){if(o===u.IS_REACTIVE)return!e;if(o===u.IS_READONLY)return e;if(o===u.IS_SHALLOW)return t;const l=Reflect.get(a,o,i);return e||((e,t)=>{if(!n)return;if(!c.get(e))return;let a=s.get(e);if(!a){a=new Map;const o=new Set;return o.add(n),a.set(t,o),void s.set(e,a)}let o=a.get(t);if(!o)return o=new Set,o.add(n),a.set(t,o),void s.set(e,a);o.add(n)})(a,o),t?l:v(l)?l.value:l&&"object"==typeof l?l instanceof Element?l:e?S(l):M(l):l},y=(e,t)=>function(a,o,i,n){if(e)return!1;const s=a[o];if(w(s)&&v(s)&&!v(i))return!1;if(!t&&v(s)&&!v(i))return s.value=i,!0;const c=Reflect.set(a,o,i,n);return Array.isArray(a)&&"length"===o?(r(a,o,i,s),c):(s!==i&&r(a,o,i,s),c)},b=(e,t,a)=>{const o=c.get(e);if(o)return o;const i=new Proxy(e,((e,t)=>({get:m(e,t),set:y(e,t)}))(t,a));return c.set(e,i),i},w=e=>!(!e||!e[u.IS_READONLY]),_=e=>{return!(!(t=e)||!t[u.IS_REACTIVE])||w(e);var t},M=e=>(e=>b(e,!1,!1))(e),S=e=>(e=>b(e,!0,!1))(e),E=(e,t,a=!1)=>{if(a&&t(f(e),f(e)),Array.isArray(e)&&e.every((e=>v(e)))){for(const a in e)_(e[a])&&E(e[a],(()=>{const a=e.map((e=>f(e)));t(a,a)}));E((()=>e.map((e=>f(e)))),t)}else if(e instanceof Function)E(D(e),((e,a)=>{t(f(e),f(a))}));else{if(!_(e))return v(e)?(_(e.value)&&E(e.value,(()=>{t(f(e),f(e))})),n=t,l(e),void(n=void 0)):void 0;for(const a in e){n=()=>{t(e,e)};const o=e[a];n=void 0,E(o,(()=>{t(e,e)}))}}},A=e=>{n=e,e(),n=void 0},C=(e,t)=>{const a=p(t());return E(e,(()=>a.value=f(t()))),a},D=e=>{const t=p(void 0);return A((()=>t.value=f(e()))),t};async function x(){const e=await chrome.windows.getCurrent(),t=e.id,a=h(e.height),o=h(e.width),i=h(e.left),n=h(e.top),s=h(e.focused),c=h(e.state);return E(a,(()=>{chrome.windows.update(t,{height:a.value})})),E(o,(()=>{chrome.windows.update(t,{width:o.value})})),E(i,(()=>{chrome.windows.update(t,{left:i.value})})),E(n,(()=>{chrome.windows.update(t,{top:n.value})})),E(s,(()=>{chrome.windows.update(t,{focused:s.value})})),E(c,(()=>{chrome.windows.update(t,{state:c.value})})),{height:a,width:o,left:i,top:n,focused:s,state:c}}const I={tabId:h(0),login:h(!1),themeColor:h("#fa3333"),settings:M([!1,!1,!1,!1,!1,!1,!1,!1]),taskConfig:M([{title:"登录",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每日首次登录积1分。",active:!0,disabled:!0,type:a.LOGIN},{title:"文章选读",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效阅读一篇文章积1分，上限6分。有效阅读文章累计1分钟积1分，上限6分。每日上限积12分。",active:!0,disabled:!1,type:a.READ},{title:"视听学习",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每有效一个音频或观看一个视频积1分，上限6分。有效收听音频或观看视频累计1分钟积1分，上限6分。每日上限积12分。",active:!0,disabled:!1,type:a.WATCH},{title:"每日答题",currentScore:0,dayMaxScore:0,need:0,status:!1,tip:"每组答题每答对1道积1分。每日上限积5分。",active:!0,disabled:!1,type:a.PRACTICE}]),isBlack:h(!1),todayScore:h(0),totalScore:h(0),maxRead:h(80),maxWatch:h(100),message:h("")};function k(e,t,a,o,i){const n=h(!1),s=h(!1),c=h(!1),l=h(!1),{onCreated:r,beforeCreat:u,onMounted:d,beforeMount:v,beforeDestroy:g,onDestroyed:f}=i||{},p=e=>{const{onMounted:t,beforeMount:a,beforeDestroy:o,onDestroyed:i}=e;a&&E(n,(()=>{n.value&&a()}),!0),t&&E(s,(()=>{s.value&&t()}),!0),o&&E(c,(()=>{c.value&&o()}),!0),i&&E(l,(()=>{l.value&&i()}),!0)};u&&u();const m=document.createElement(e);T(m,t),P(m,a,p),N(m,o,p,(e=>{}));return r&&r(),{ele:m,beforeMount:()=>{n.value=!0,v&&v()},onMounted:()=>{s.value=!0,d&&d()},beforeDestroy:()=>{c.value=!0,g&&g()},onDestroyed:()=>{l.value=!0,f&&f()}}}function R(e,t,a,o,i){const n=h(!1),s=h(!1),c=h(!1),l=h(!1),{onCreated:r,beforeCreat:u,onMounted:d,beforeMount:v,beforeDestroy:g,onDestroyed:f}=i||{},p=e=>{const{onMounted:t,beforeMount:a,beforeDestroy:o,onDestroyed:i}=e;a&&E(n,(()=>{n.value&&a()}),!0),t&&E(s,(()=>{s.value&&t()}),!0),o&&E(c,(()=>{c.value&&o()}),!0),i&&E(l,(()=>{l.value&&i()}),!0)};u&&u();const m=document.createElementNS("http://www.w3.org/2000/svg",e);T(m,t),P(m,a,p),N(m,o,p,(e=>{}));return r&&r(),{ele:m,beforeMount:()=>{n.value=!0,v&&v()},onMounted:()=>{s.value=!0,d&&d()},beforeDestroy:()=>{c.value=!0,g&&g()},onDestroyed:()=>{l.value=!0,f&&f()}}}function T(e,t){for(const a in t)if(v(t[a])){const o=t[a];A((()=>e[a]=o.value))}else e[a]=t[a]}function P(e,t,a,o){if(t)for(const o in t)O(e,o,t[o],a)}function O(e,t,a,o,i){const n=t.toLowerCase();if(n.startsWith("on")){const[t]=n.match(/(?<=on).*/);if(t){const[o,...i]=t.split("_"),n=function(e){if(e.length)return{capture:e.includes("capture"),once:e.includes("once"),passive:e.includes("passive")}}(i);if(v(a)){const t=a,s=C(t,(()=>t.value?e=>{i.includes("prevent")&&e.preventDefault(),i.includes("stop")&&e.stopPropagation();(0,t.value)(e)}:void 0));return s.value&&e.addEventListener(o,s.value,n),void E(s,((t,a)=>{a&&e.removeEventListener(o,a),t&&e.addEventListener(o,t,n)}))}a instanceof Function&&e.addEventListener(o,a,n)}return}if(["checked","selected","disabled","enabled"].includes(n)){if(v(a)){const t=a;return void A((()=>{t.value?e.setAttribute(n,""):e.removeAttribute(n)}))}a?e.setAttribute(n,""):e.removeAttribute(n)}else if("ref"!==t)if(t.startsWith("xlink:")){const o="http://www.w3.org/1999/xlink";a?e.setAttributeNS(o,t,a):e.removeAttributeNS(o,t)}else if(t&&v(a)){const o=a;A((()=>{e.setAttribute(t,o.value)}))}else t&&e.setAttribute(t,a);else{if(v(a)){const t=a;return void(o&&o({onMounted(){t.value=e}}))}if(a instanceof Function){const t=a;return void(o&&o({onMounted(){t(e)}}))}}}function N(e,t,a,o){if(v(t)){const i=document.createComment("");if(E(t,(async(t,n)=>{if(t||!n)if(t){if(n){if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}n instanceof Promise||n.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}if(t instanceof Promise){const o=await t;if(o){const t=o.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.replaceChildren(H(t))}return}const i=t.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));if(e.replaceChildren(H(i)),n){if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}n instanceof Promise||n.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}}else;else{if(n instanceof Promise){const e=await n;e&&e.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()}))}if(n instanceof Promise||n.forEach((e=>{o&&o(e),e.beforeDestroy&&e.beforeDestroy()})),e.replaceChildren(i),n instanceof Promise){const e=await n;e&&e.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}n instanceof Promise||n.forEach((e=>{e.onDestroyed&&e.onDestroyed()}))}})),t.value instanceof Promise)return e.appendChild(i),void t.value.then((t=>{if(t){const o=t.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.replaceChildren(H(o))}}));if(t.value){const o=t.value.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));return void e.appendChild(H(o))}e.appendChild(i)}else{if(t instanceof Promise){const o=document.createComment("");return e.appendChild(o),void t.then((e=>{if(e){const{beforeMount:t,onMounted:i}=e;(t||i)&&a&&a(e),o.replaceWith(e.ele)}}))}if(Array.isArray(t)){const i=[];for(const e in t){const n=t[e];if(v(n)){const t=document.createComment("");if(E(n,(async(e,i)=>{if(e||!i)if(!e||i){if(e&&i){if(e instanceof Promise&&i instanceof Promise){return void W(await e,await i,t,a,o)}if(e instanceof Promise&&!(i instanceof Promise)){return void W(await e,i,t,a,o)}if(!(e instanceof Promise)&&i instanceof Promise){return void W(e,await i,t,a,o)}if(!(i instanceof Promise||e instanceof Promise))return void W(e,i,t,a,o)}}else{if(e instanceof Promise){const n=await e;return void(n&&W(n,i,t,a,o))}W(e,i,t,a,o)}else{if(i instanceof Promise){const n=await i;return void(n&&W(e,n,t,a,o))}W(e,i,t,a,o)}})),n.value instanceof Promise){i[e]={ele:t},n.value.then((e=>{if(e){const{beforeMount:o,onMounted:i}=e;(o||i)&&a&&a(e),t.replaceWith(e.ele)}}));continue}if(n.value){const{beforeMount:t,onMounted:a,ele:o}=n.value;i[e]={ele:o,beforeMount:t,onMounted:a};continue}i[e]={ele:t}}else if(n instanceof Promise){const t=document.createComment("");i[e]={ele:t},n.then((e=>{if(e){const{beforeMount:o,onMounted:i}=e;(o||i)&&a&&a(e),t.replaceWith(e.ele)}}))}else if(n){const{beforeMount:t,onMounted:a,ele:o}=n;i[e]={ele:o,beforeMount:t,onMounted:a}}}const n=i.map((e=>((e.beforeMount||e.onMounted)&&a&&a(e),e.ele)));e.appendChild(H(n))}else if(t){const{beforeMount:o,onMounted:i}=t;return(o||i)&&a&&a(t),void e.appendChild(t.ele)}}}function W(e,t,a,o,i){if(e&&t){const{beforeMount:a,onMounted:i}=e;return(a||i)&&o&&o(e),t.beforeDestroy&&t.beforeDestroy(),t.ele.replaceWith(e.ele),void(t.onDestroyed&&t.onDestroyed())}if(e&&!t){const{beforeMount:t,onMounted:i}=e;return(t||i)&&o&&o(e),void a.replaceWith(e.ele)}if(!e&&t)return i&&i(t),t.beforeDestroy&&t.beforeDestroy(),t.ele.replaceWith(a),void(t.onDestroyed&&t.onDestroyed())}function L(e,t){const{onCreated:a,beforeCreat:o,onMounted:i,beforeMount:n,onDestroyed:s,beforeDestroy:c}=t||{};if(o&&o(),v(e)){const t=e,o=document.createTextNode("");return A((()=>{o.data=t.value})),a&&a(),{ele:o,beforeMount:n,onMounted:i,onDestroyed:s,beforeDestroy:c}}return a&&a(),{ele:document.createTextNode(String(e)),beforeMount:n,onMounted:i,beforeDestroy:c,onDestroyed:s}}function H(e){const t=document.createDocumentFragment();for(const a in e)t.appendChild(e[a]);return t}function U(e){return e<10?`0${e}`:`${e}`}function $(...e){q("dodgerblue",...e)}function B(...e){q("red",...e)}function q(e,...t){const a=t.map((e=>!(e instanceof Function)&&e instanceof Object?e instanceof Error?e.stack:JSON.stringify(e):String(e))).join(" ");console.log(`%c[${function(e=Date.now()){const t=new Date(e),a=t.getSeconds(),o=t.getMinutes(),i=t.getHours(),n=t.getDate(),s=t.getMonth()+1;return`${[t.getFullYear(),s,n].map(U).join("-")} ${[i,o,a].map(U).join(":")}`}()}] %c${a}`,"",`color: ${e}`)}async function V(e,t){const{data:a,type:o}=t;return"tab"===o?await chrome.tabs.sendMessage(t.id,{data:a,action:e}):"runtime"===o?await chrome.runtime.sendMessage({data:a,action:e}):void 0}function F(e,t,a){const{once:o}=a||{},i=(a,i,s)=>{const{action:c,data:l}=a;if(c&&e===c)return t(l,i,s),void(o&&n())},n=()=>{chrome.runtime.onMessage.removeListener(i)};return chrome.runtime.onMessage.addListener(i),n}function G(){const e=[];return{listeners:e,addListener(t,a,o){const i=Math.random().toString(16).substring(2);e.push({id:i,action:t,callback:a,cancel:F(t,a,o)})},removeAllListeners(){for(;;){const t=e.pop();if(!t)break;t.cancel()}},removeListener(t){const a=e.findIndex((e=>e.id===t));-1!==a&&(e[a].cancel(),e.splice(a,1))},fechListenerData:e=>new Promise((e=>{}))}}function z(e,t){return new Promise((async(a,o)=>{const i=setTimeout((()=>{n(),o("请求超时!")}),t.timeout||6e3),n=F(e,(e=>{clearTimeout(i),n(),a(e)}));try{await V(e,t)}catch(e){o(e)}}))}const J={version:"1.0.0.alpha1",name:"tech-study-plugin"};function j(e,t){let a=-1;return function(...o){-1!==a&&clearTimeout(a),a=setTimeout((()=>{e.apply(this,o)}),t)}}function X(e){let t=Number(e);return Number.isInteger(t)||(t=1e3),new Promise((e=>{setTimeout((()=>{e()}),t)}))}async function K(e,t){return await chrome.notifications.create({iconUrl:"../assets/icon.jpg",title:"提示",type:"basic",message:e,...t})}function Y(e=0,t){let a=e,o=-1,i=!1;return{wait:()=>new Promise((e=>{o=setInterval((async()=>i?(clearInterval(o),void e(void 0)):(t&&await t(a),a<=0?(clearInterval(o),void e(void 0)):void a--)),1e3)})),cancel(){a<=0||(i=!0)}}}function Z(e,t,a){const{once:o}=a||{},i=(a,i)=>{if(e===a)return t(a,i),void(o&&n())},n=()=>{chrome.tabs.onRemoved.removeListener(i)};return chrome.tabs.onRemoved.addListener(i),n}function Q(e,t){return new Promise((a=>{const o=setInterval((async()=>{await e()&&(t&&clearTimeout(i),clearInterval(o),a(!0))}),500);if(!t)return;const i=setTimeout((()=>{clearInterval(o),a(!1)}),t)}))}function ee(e){return{x:e.border[0],y:e.border[1],width:e.width,height:e.height}}function te({text:e}){return k("div",void 0,{class:"egg_hr_wrap"},[k("div",void 0,{class:"egg_hr"}),k("div",void 0,{class:"egg_hr_title"},L(e)),k("div",void 0,{class:"egg_hr"})])}function ae({paths:e,viewBox:t="0 0 1024 1024"}){return R("svg",void 0,{viewBox:t,class:"egg_icon"},e.map((e=>R("path",void 0,{d:e}))))}function oe(){const{message:e}=I;return k("div",void 0,{class:"egg_message_item"},[D((()=>e.value?k("div",void 0,{class:"egg_message_content"},L(e)):void 0))])}function ie({tip:e}){return k("button",void 0,{type:"button",class:"egg_detail",title:e},L("i"))}function ne({tip:e="",checked:t=!1,disabled:a=!1,onchange:o}){return k("input",{checked:t},{title:e,class:"egg_switch",type:"checkbox",disabled:a,onchange:o})}function se({title:e,tip:t,checked:a,onchange:o}){return k("div",void 0,{class:"egg_setting_item"},[k("div",void 0,{class:"egg_label_wrap"},[k("label",void 0,{class:"egg_task_title"},[L(e),ie({tip:t})])]),ne({tip:t,checked:a,onchange:o})])}function ce({show:e}){const{taskConfig:t,todayScore:a}=I;return k("div",void 0,{class:D((()=>"egg_score_panel"+(e.value?" active":"")))},[k("div",void 0,{class:"egg_score_title"},[ae({paths:["M314.81 304.01h415.86v58.91H314.81zM314.81 440.24h415.86v58.91H314.81z","M814.8 892.74h-8.64l-283.51-182-283.51 182h-8.64A69.85 69.85 0 0 1 160.72 823V188.22a69.85 69.85 0 0 1 69.77-69.77H814.8a69.85 69.85 0 0 1 69.77 69.77V823a69.85 69.85 0 0 1-69.77 69.74zM230.5 177.35a10.87 10.87 0 0 0-10.86 10.86V823a10.86 10.86 0 0 0 5 9.11l298.01-191.42 298.06 191.38a10.86 10.86 0 0 0 5-9.11V188.22a10.87 10.87 0 0 0-10.86-10.86z"]}),k("div",void 0,{class:"egg_score_title_text"},L("积分详情"))]),...t.map((e=>k("div",void 0,{class:"egg_score_detail_item"},[L(e.title),k("span",void 0,void 0,L(D((()=>e.currentScore))))]))),k("div",void 0,{class:"egg_score_detail_item"},[L("其他"),k("span",void 0,void 0,L(D((()=>a.value-t.reduce(((e,t)=>e+t.currentScore),0)))))])])}function le(){const{todayScore:e,totalScore:t,login:a}=I,o=h(!1);return k("div",void 0,{class:"egg_score_item"},k("div",void 0,{class:"egg_scoreinfo"},[k("div",void 0,{class:"egg_total_score"},[L("总积分"),k("span",void 0,void 0,L(t))]),k("button",void 0,{class:"egg_today_score",type:"button",onclick:j((()=>{o.value=!o.value}),300),onblur(){o.value=!1}},[L("当天分数"),k("span",void 0,void 0,L(e)),ae({paths:["M332.16 883.84a40.96 40.96 0 0 0 58.24 0l338.56-343.04a40.96 40.96 0 0 0 0-58.24L390.4 140.16a40.96 40.96 0 0 0-58.24 58.24L640 512l-307.84 314.24a40.96 40.96 0 0 0 0 57.6z"]}),ce({show:o})])]),{onMounted(){A((()=>{a.value||(e.value=0,t.value=0)}))}})}function re({data:e,maxlength:t,placeholder:a="",onchange:o,onblur:i,value:n,keep:s}){const c=M(e.map((e=>({selected:!1,active:!1,ele:void 0,...e})))),l=h(!1),r=p(void 0),u=p(void 0),d=h("");return n&&E(n,(()=>{const e=c.find((e=>e.value===n.value));d.value=e?e.label:"",e||(c.forEach((e=>e.selected=!1)),u.value&&(u.value.scrollTop=0))}),!0),k("div",void 0,{class:"egg_select"},[k("input",{value:d},{class:"egg_select_input",type:"text",placeholder:a,maxlength:t,ref:r,onfocus(){if(u.value&&r.value&&(l.value=!0,r.value.value&&d.value)){const e=c.findIndex((e=>e.label===d.value));e+1&&(u.value.scrollTop=c[e].ele?.offsetTop||0,c.forEach(((t,a)=>t.selected=a===e)))}else;},oninput(){if(u.value&&r.value){const{value:e}=r.value;if(e){const t=c.findIndex((t=>t.label.includes(e)));return void(t+1&&(u.value.scrollTop=c[t].ele?.offsetTop||0,c.forEach(((e,a)=>{e.active=a===t,e.active&&setTimeout((()=>{e.active=!1}),300)}))))}c.forEach((e=>e.active=e.selected=!1)),u.value.scrollTop=0}},onblur(){if(u.value&&r.value){const e=c.find((e=>e.selected));!e&&r.value.value||setTimeout((()=>{l.value=!1}),100),e&&r.value.value!==e.label&&(r.value.value=e.label),!e&&s&&(r.value.value=d.value),i&&i(e?{label:e.label,value:e.value}:void 0)}}}),k("div",void 0,{class:D((()=>"egg_select_list"+(l.value?" active":""))),ref:u},c.map(((e,t)=>k("div",void 0,{class:C((()=>[e.selected,e.active]),(()=>"egg_select_item"+(e.selected?" selected":e.active?" active":""))),ref:t=>e.ele=t,onclick:j((()=>{d.value!==e.label&&(o&&o({label:e.label,value:e.value}),c.forEach(((e,a)=>{e.selected=a===t,e.selected&&(d.value=e.label)}))),l.value=!1}),300)},L(e.label)))))])}function ue({hour:e,minute:t,onchange:a}){const o=new Array(24).fill(void 0).map(((e,t)=>({value:t,label:U(t)}))),i=new Array(60).fill(void 0).map(((e,t)=>({value:t,label:U(t)}))),n=D((()=>{const a=o.find((t=>t.value===e.value)),n=i.find((e=>e.value===t.value));return{hour:a?a.value:-1,minute:n?n.value:-1}}));return k("div",void 0,{class:"egg_time_input"},[k("div",void 0,{class:"egg_hour_wrap"},[re({data:o,placeholder:"00",maxlength:2,value:e,onchange({value:e}){n.value.hour=e,a&&a(n.value)},onblur(e){e||(n.value.hour=-1,a&&a(n.value))}})]),k("span",void 0,{class:"egg_separator"},L(":")),k("div",void 0,{class:"egg_minute_wrap"},[re({data:i,placeholder:"00",maxlength:2,value:t,onchange({value:e}){n.value.minute=e,a&&a(n.value)},onblur(e){e||(n.value.minute=-1,a&&a(n.value))}})])])}function de({settingsShow:e,themeColor:a,settings:o}){const i=[{value:"#fa3333",title:"强国红",detail:"XueXi Red",code:"none"},{value:"#bb2649",title:"非凡洋红",detail:"Viva Magenta",code:"18-1750"},{value:"#35548a",title:"经典蓝",detail:"Classic Blue",code:"19-4052"},{value:"#f36f63",title:"活珊瑚橘",detail:"Living Coral",code:"16-1546"},{value:"#6d5b97",title:"紫外光色",detail:"Ultra Violet",code:"18-3838"},{value:"#86af49",title:"草木绿",detail:"Greenery",code:"15-0343"},{value:"#fc8bab",title:"B站粉",detail:"Bilibili Pink",code:"none"},{value:"#056de8",title:"知乎蓝",detail:"Zhihu Blue",code:"none"}],{maxRead:n,maxWatch:s}=I,c=h(""),l=h(-1),r=h(-1),u=h(!1);return M([]),k("div",void 0,{class:D((()=>"egg_settings_panel_wrap"+(e.value?" active":"")))},k("div",void 0,{class:"egg_settings_panel"},[k("div",void 0,{class:"egg_back_wrap"},[k("button",void 0,{class:"egg_btn",title:"返回",type:"button",onclick:j((()=>{e.value=!1}),300)},ae({paths:["M942.545455 478.021818H165.748364l361.239272-361.192727a34.909091 34.909091 0 1 0-49.384727-49.384727L56.785455 488.261818a33.838545 33.838545 0 0 0-7.493819 11.264 34.536727 34.536727 0 0 0 7.493819 38.120727l420.817454 420.817455a34.816 34.816 0 0 0 49.338182 0 34.909091 34.909091 0 0 0 0-49.384727l-361.239273-361.192728h776.843637a34.909091 34.909091 0 0 0 0-69.864727z"]})),L("设置")]),k("div",void 0,{class:"egg_settings_content"},[k("div",void 0,{class:"egg_settings_version_wrap"},[k("div",void 0,{class:"egg_settings_label"},L("版本信息")),k("div",void 0,{class:"egg_settings_version"},[L(`v${J.version}`),k("button",void 0,{type:"button",class:"egg_settings_version_detail",title:"GitHub Xu22Web/tech-study-plugin",onclick(){chrome.tabs.create({url:"https://github.com/Xu22Web/tech-study-plugin",active:!0})}},ae({paths:["M8 0c4.42 0 8 3.58 8 8a8.013 8.013 0 0 1-5.45 7.59c-.4.08-.55-.17-.55-.38 0-.27.01-1.13.01-2.2 0-.75-.25-1.23-.54-1.48 1.78-.2 3.65-.88 3.65-3.95 0-.88-.31-1.59-.82-2.15.08-.2.36-1.02-.08-2.12 0 0-.67-.22-2.2.82-.64-.18-1.32-.27-2-.27-.68 0-1.36.09-2 .27-1.53-1.03-2.2-.82-2.2-.82-.44 1.1-.16 1.92-.08 2.12-.51.56-.82 1.28-.82 2.15 0 3.06 1.86 3.75 3.64 3.95-.23.2-.44.55-.51 1.07-.46.21-1.61.55-2.33-.66-.15-.24-.6-.83-1.23-.82-.67.01-.27.38.01.53.34.19.73.9.82 1.13.16.45.68 1.31 2.69.94 0 .67.01 1.3.01 1.49 0 .21-.15.45-.55.38A7.995 7.995 0 0 1 0 8c0-4.42 3.58-8 8-8Z"],viewBox:"0 0 16 16"}))])]),k("div",void 0,{class:"egg_settings_theme_wrap"},[k("div",void 0,{class:"egg_settings_title"},[k("div",void 0,{class:"egg_settings_label"},L("主题预设")),k("div",void 0,{class:"egg_settings_current_theme"},L(D((()=>i.find((e=>e.value===a.value)).title))))]),k("div",void 0,{class:"egg_settings_theme_colors"},i.map((e=>k("div",void 0,{class:"egg_settings_theme_color_wrap",style:`--color: ${e.value}`},k("button",void 0,{class:D((()=>"egg_settings_theme_color"+(a.value===e.value?" active":""))),type:"button",title:e.title,onclick:j((()=>{a.value!==e.value&&(a.value=e.value,chrome.storage.local.set(JSON.parse(JSON.stringify({themeColor:a}))),K(`主题色已保存为${e.title}`))}),300)})))))],{async beforeCreat(){const{themeColor:e}=await chrome.storage.local.get("themeColor");e&&(a.value=e),chrome.storage.local.onChanged.addListener((e=>{for(let[t,{newValue:o}]of Object.entries(e))"themeColor"===t&&(a.value=o)}))}}),k("div",void 0,{class:"egg_settings_read_time_wrap"},[k("div",void 0,{class:"egg_settings_label"},L("最大文章时长")),re({data:[{label:"40s",value:40},{label:"60s",value:60},{label:"80s",value:80},{label:"100s",value:100}],value:n,placeholder:"100s",maxlength:4,keep:!0,onchange({value:e}){n.value=e,chrome.storage.local.set(JSON.parse(JSON.stringify({maxRead:n}))),K(`最大文章选读时间改为${e}s`)}})],{async beforeCreat(){const{maxRead:e}=await chrome.storage.local.get("maxRead");e&&(n.value=e),chrome.storage.local.onChanged.addListener((e=>{for(let[t,{newValue:a}]of Object.entries(e))"maxRead"===t&&(n.value=a)}))}}),k("div",void 0,{class:"egg_settings_watch_time_wrap"},[k("div",void 0,{class:"egg_settings_label"},L("最大视听时长")),re({data:[{label:"40s",value:40},{label:"60s",value:60},{label:"80s",value:80},{label:"100s",value:100},{label:"120s",value:120}],value:s,placeholder:"120s",maxlength:4,keep:!0,onchange({value:e}){s.value=e,chrome.storage.local.set(JSON.parse(JSON.stringify({maxWatch:s}))),K(`最大视听学习时间改为${e}s`)}})],{async beforeCreat(){const{maxWatch:e}=await chrome.storage.local.get("maxWatch");e&&(s.value=e),chrome.storage.local.onChanged.addListener((e=>{for(let[t,{newValue:a}]of Object.entries(e))"maxWatch"===t&&(s.value=a)}))}}),D((()=>o[t.REMOTE_PUSH]?k("div",void 0,{class:"egg_settings_token_wrap"},[k("div",void 0,{class:"egg_settings_token"},[k("div",void 0,{class:"egg_settings_label"},L("我的 token")),k("input",void 0,{class:"egg_settings_token_input",placeholder:"用户 token",maxlength:32,value:c.value,onfocus:e=>{e.target.classList.add("active"),u.value=!0},onblur:e=>{const t=e.target,a=t.value.trim();/^[0-9a-z]{32}$/.test(a)&&(t.value=a),t.classList.remove("active"),setTimeout((()=>{u.value=!1,t.value=c.value}),200)}})]),k("div",void 0,{class:D((()=>"egg_settings_submit_btn_wrap"+(u.value?" active":"")))},k("button",void 0,{class:"egg_settings_submit_btn",onclick:j((()=>{}),300)},L("保存")))]):void 0)),D((()=>o[t.SCHEDULE_RUN]?k("div",void 0,{class:"egg_schedule"},[k("div",void 0,{class:"egg_schedule_time_wrap"},[k("div",void 0,{class:"egg_schedule_time"},[k("div",void 0,{class:"egg_schedule_label"},L("设置时间")),k("div",void 0,{class:"egg_schedule_time_input_wrap"},[ue({hour:l,minute:r,onchange({hour:e,minute:t}){l.value=e,r.value=t}}),k("button",void 0,{class:"egg_schedule_add_btn",onclick:j((()=>{}),300)},R("svg",void 0,{viewBox:"0 0 1024 1024",class:"egg_icon"},R("path",void 0,{d:"M801.171 483.589H544V226.418c0-17.673-14.327-32-32-32s-32 14.327-32 32v257.171H222.83c-17.673 0-32 14.327-32 32s14.327 32 32 32H480v257.17c0 17.673 14.327 32 32 32s32-14.327 32-32v-257.17h257.171c17.673 0 32-14.327 32-32s-14.327-32-32-32z"})))])])])]):void 0))])]))}async function ve(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchMouseEvent",t)}async function ge(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchKeyEvent",t)}async function fe(e,t){await chrome.debugger.sendCommand({tabId:e},"Input.dispatchTouchEvent",t)}function he(e){return{dispatchKeyEvent:t=>ge(e,t),dispatchKeyPressEvent:t=>async function(e,t){await ge(e,{type:"keyDown",...t}),await ge(e,{type:"keyUp",...t})}(e,t),dispatchKeyInputEvent:t=>async function(e,t){for(const a of t)await ge(e,{type:"char",...a})}(e,t),dispatchMouseClickEvent:t=>async function(e,t){await ve(e,{type:"mousePressed",...t}),await ve(e,{type:"mouseReleased",...t})}(e,t),dispatchMouseEvent:t=>ve(e,t),dispatchMouseMoveEvent:t=>async function(e,t){await ve(e,{type:"mouseMoved",...t})}(e,t),dispatchMouseWheelEvent:t=>async function(e,t){"up"!==t.direction?"down"!==t.direction||await ve(e,{type:"mouseWheel",deltaX:-0,deltaY:100,...t}):await ve(e,{type:"mouseWheel",deltaX:-0,deltaY:-100,...t})}(e,t),dispatchMouseSlideEvent:t=>async function(e,t){await ve(e,{type:"mousePressed",...t[0]});for(const a of t)await ve(e,{type:"mouseMoved",...a});await ve(e,{type:"mouseReleased",...t[t.length-1]})}(e,t),dispatchTouchSlideEvent:t=>async function(e,t){await fe(e,{type:"touchStart",...t[0]});for(const a of t)await fe(e,{type:"touchMove",...a});await fe(e,{type:"touchEnd",...t[t.length-1]})}(e,t),dispatchTouchTapEvent:t=>async function(e,t){await fe(e,{type:"touchStart",...t}),await fe(e,{type:"touchEnd",...t})}(e,t),dispatchTouchEvent:t=>fe(e,t)}}function pe(e){return{getDocument:t=>async function(e,t){return await chrome.debugger.sendCommand({tabId:e},"DOM.getDocument",t)}(e,t),querySelector:t=>async function(e,t){return await chrome.debugger.sendCommand({tabId:e},"DOM.querySelector",t)}(e,t),querySelectorAll:t=>async function(e,t){return await chrome.debugger.sendCommand({tabId:e},"DOM.querySelectorAll",t)}(e,t),getBoxModel:t=>async function(e,t){return await chrome.debugger.sendCommand({tabId:e},"DOM.getBoxModel",t)}(e,t),focus:t=>async function(e,t){return await chrome.debugger.sendCommand({tabId:e},"DOM.focus",t)}(e,t)}}async function me(e,t){const{getDocument:a,querySelector:o,querySelectorAll:i,getBoxModel:n,focus:s}=pe(e),{root:{nodeId:c}}=await a(t);return{querySelector:e=>o({nodeId:c,selector:e}),querySelectorAll:e=>i({nodeId:c,selector:e}),getBoxModel:e=>n({nodeId:e}),focus:e=>s({nodeId:e})}}function ye(e){const{x:t,y:a,width:o,height:i}=e;return{x:t+Math.random()*o*.5+.25*o,y:a+Math.random()*i*.5+.25*i}}function be(){const{taskConfig:n,todayScore:s,totalScore:c,tabId:l,maxRead:r,maxWatch:u,settings:d,isBlack:v}=I,g=h(o.LOADING),f=h(!1),p=async()=>{await(async()=>{try{const e=await z("getTaskProgress",{type:"tab",id:l.value,data:null});if(!e)return!1;const{taskProgress:t,inBlackList:a}=e;return t.forEach(((e,t)=>{n[t].currentScore=e.currentScore,n[t].dayMaxScore=e.dayMaxScore,n[t].status=e.status,n[t].need=e.need})),v.value=a,!0}catch(e){return!1}})(),await(async()=>{try{const e=await z("getTodayScore",{type:"tab",id:l.value,data:null});return!!e&&(s.value=e,!0)}catch(e){return!1}})(),await(async()=>{try{const e=await z("getTotalScore",{type:"tab",id:l.value,data:null});return!!e&&(c.value=e,!0)}catch(e){return!1}})()},m=async()=>{await Q((()=>(f.value&&$("等待中..."),!f.value)));try{const e=await z("getNews",{type:"tab",id:l.value,data:n[a.READ].need}),t=await x();for(const o in e){$(`阅读第${Number(o)+1}篇文章`),await Q((()=>(f.value&&$("等待中..."),!f.value)));const s=await chrome.tabs.create({url:e[o].url,active:!0}),c=s.id;await chrome.tabs.update(c,{autoDiscardable:!1});let l=!1;t.height.value=720,await chrome.debugger.attach({tabId:c},"1.3");const{dispatchMouseWheelEvent:u}=he(c);if(await Q((async()=>{try{return await z("load",{type:"tab",id:c})}catch(e){return!1}}),6e3)){$("页面加载成功!");try{const e=await z("getData",{type:"tab",data:{max:r.value,type:i.READ},id:s.id});if(!e){B("获取页面信息失败!");continue}const{height:t,duration:a,innerWidth:o,innerHeight:n}=e,d=ye({x:0,y:0,width:o,height:n}),v=~~(12*t/(120*a)),{wait:g,cancel:h}=Y(a,(async e=>{if(await Q((()=>(f.value&&$("等待中..."),!f.value))),$(`剩余${e}s`),e&&e%12==0){let e=v;for(;e--;)await u({direction:"down",...d})}}));F("unload",(async()=>{l||(h(),$("刷新标签页, 取消倒计时"))}),{once:!0}),Z(c,(()=>{l=!0,h(),$("关闭标签页, 取消倒计时")}),{once:!0}),await g()}catch(e){B(e)}if(l||(await chrome.debugger.detach({tabId:c}),t.height.value=700,l=!0,await chrome.tabs.remove(c)),await p(),!n[a.READ].active||n[a.READ].active&&n[a.READ].status)break}else B("页面加载失败!")}}catch(e){B("获取新闻失败!",e)}await Q((()=>(f.value&&$("等待中..."),!f.value))),n[a.READ].active&&!n[a.READ].status&&await m()},y=async()=>{await Q((()=>(f.value&&$("等待中..."),!f.value)));try{const e=await z("getVideos",{type:"tab",id:l.value,data:n[a.WATCH].need}),o=await x();for(const s in e){$(`观看第${Number(s)+1}个视频`),await Q((()=>(f.value&&$("等待中..."),!f.value)));const c=(await chrome.tabs.create({url:e[s].url,active:!0})).id;await chrome.tabs.update(c,{autoDiscardable:!1});let l=!1;o.height.value=720,await chrome.debugger.attach({tabId:c},"1.3");const{dispatchMouseWheelEvent:r,dispatchMouseClickEvent:v}=he(c);if(await Q((async()=>{try{return await z("load",{type:"tab",id:c})}catch(e){return!1}}),6e3)){$("页面加载成功!");try{const e=await z("getData",{type:"tab",data:{max:u.value,type:i.WATCH},id:c});if(!e){B("获取页面信息失败!");continue}A((()=>{!l&&V("muted",{type:"tab",id:c,data:d[t.VIDEO_MUTED]})})),A((()=>{!l&&V("pause",{type:"tab",id:c,data:f.value})}));const{duration:a,innerWidth:o,innerHeight:n}=e,s=ye({x:0,y:0,width:o,height:n});let g=3;for(;g--;)await r({direction:"down",...s});await v({button:"left",clickCount:1,...s});if(!await Q((async()=>{try{return await z("play",{type:"tab",id:c})}catch(e){return!1}}),1e4)){B("视频播放失败!");continue}$("视频播放成功!");const{wait:h,cancel:p}=Y(a,(async e=>{await Q((()=>(f.value&&$("等待中..."),!f.value))),$(`剩余${e}s`)}));F("unload",(async()=>{l||(p(),$("刷新标签页, 取消倒计时"))}),{once:!0}),Z(c,(()=>{l=!0,p(),$("关闭标签页, 取消倒计时")}),{once:!0}),await h()}catch(e){B(e)}if(l||(await chrome.debugger.detach({tabId:c}),o.height.value=700,l=!0,await chrome.tabs.remove(c)),await p(),!n[a.WATCH].active||n[a.WATCH].active&&n[a.WATCH].status)break}else B("页面加载失败!")}}catch(e){B("获取视频失败!",e)}await Q((()=>(f.value&&$("等待中..."),!f.value))),n[a.WATCH].active&&!n[a.WATCH].status&&await y()},b=async e=>{const t=await me(e),{dispatchMouseSlideEvent:a}=he(e),o=await t.querySelector(".nc_scale"),i=await t.querySelector(".btn_slide"),{model:n}=await t.getBoxModel(o.nodeId),{model:s}=await t.getBoxModel(i.nodeId),c=ee(n),l=function(e,t,a){const o=(t.x-e.x)/a,i=(t.y-e.y)/a,n=[];n.push(e);for(let e=0;e<a;e++){const t=n[e].x+5*Math.random()+o,a=n[e].y+5*Math.random()*Math.pow(-1,~~(2*Math.random()+1))+i;n.push({x:t,y:a})}return n}(ye(ee(s)),{x:c.x+c.width,y:c.y+c.height/2},10);await a(l.map((e=>({button:"left",clickCount:1,...e}))))},w=async({doc:e,dispatchMouseClickEvent:t})=>{const a=await e.querySelector(".tips"),{model:o}=await e.getBoxModel(a.nodeId),i=ee(o);await Q((async()=>{const a=ye(i);await t({button:"left",clickCount:1,...a});return!!(await e.querySelector(".tips.ant-popover-open")).nodeId})),await Q((async()=>{const a=ye(i);await t({button:"left",clickCount:1,...a});return!(await e.querySelector(".tips.ant-popover-open")).nodeId}))},_=async({id:e,type:t,doc:a,dispatchMouseClickEvent:o,dispatchKeyInputEvent:i})=>{const n=await z("answers",{type:"tab",id:e});if($("答案",n),n){if(await X(2e3),await Q((()=>(f.value&&$("等待中..."),!f.value))),"多选题"===t){const e=n,{nodeIds:t}=await a.querySelectorAll(".q-answer"),i=e.map((e=>t[e])),s=(await Promise.all(i.map((e=>a.getBoxModel(e))))).map((({model:e})=>ye(ee(e))));for(const e of s)await o({button:"left",clickCount:1,...e}),await X(500)}if("单选题"===t){const[e]=n,{nodeIds:t}=await a.querySelectorAll(".q-answer"),{model:i}=await a.getBoxModel(t[e]),s=ye(ee(i));await o({button:"left",clickCount:1,...s}),await X(300)}if("填空题"===t){const e=n,{nodeIds:t}=await a.querySelectorAll(".blank");for(const n in t){const s=t[n],c=e[n],{model:l}=await a.getBoxModel(s),r=ye(ee(l));await o({button:"left",clickCount:1,...r}),await X(300);const u=c.split("");await i(u.map((e=>({text:e})))),await X(300)}}}},M=async()=>{await Q((()=>(f.value&&$("等待中..."),!f.value)));const t=await x(),o=(await chrome.tabs.create({url:e.examPractice,active:!0})).id;await chrome.tabs.update(o,{autoDiscardable:!1});let i=!1;t.height.value=720,Z(o,(()=>{i=!0,$("关闭标签页")}),{once:!0});if(!await Q((async()=>{try{return await z("load",{type:"tab",id:o})}catch(e){return!1}}),1e4))return void B("题目加载失败!");$("题目加载成功!"),await chrome.debugger.attach({tabId:o},"1.3");const{dispatchMouseWheelEvent:s,dispatchMouseClickEvent:c,dispatchKeyInputEvent:l}=he(o);try{let e=4;for(;e--;)await s({direction:"down",x:120,y:120});await z("wheel",{type:"tab",id:o});const t=await me(o);for(;!i;){await Q((()=>(f.value&&$("等待中..."),!f.value)));let e=await z("next",{type:"tab",id:o});if(["再练一次","再来一组","查看解析"].includes(e))break;const{type:a,total:i,current:n}=await z("questionData",{type:"tab",id:o});if($(`${n}/${i} 题型: ${a}`),await w({doc:t,dispatchMouseClickEvent:c}),await _({id:o,doc:t,type:a,dispatchMouseClickEvent:c,dispatchKeyInputEvent:l}),e=await z("next",{type:"tab",id:o}),"确定"===e){const{nodeId:e}=await t.querySelector(".next-btn"),{model:a}=await t.getBoxModel(e),o=ye(ee(a));await c({button:"left",clickCount:1,...o})}if(e=await z("next",{type:"tab",id:o}),"下一题"===e||"完成"===e||"交卷"===e){await X(2500);const{nodeId:e}=await t.querySelector(".next-btn"),{model:a}=await t.getBoxModel(e),o=ye(ee(a));await c({button:"left",clickCount:1,...o})}if(n===i){if(await z("slideVerify",{type:"tab",id:o})){$("处理滑动验证..."),await X(2e3),await b(o),await X(2e3);$("滑动验证"+(await z("slideVerify",{type:"tab",id:o})?"成功":"失败"))}}}$("答题结束!")}catch(e){B(e)}return i||(await chrome.debugger.detach({tabId:o}),t.height.value=700,i=!0,await chrome.tabs.remove(o)),await Q((()=>(f.value&&$("等待中..."),!f.value))),await p(),n[a.PRACTICE].active&&!n[a.PRACTICE].status?await M():void 0},S=async()=>{g.value=o.PROGRESS,n[a.READ].active&&!n[a.READ].status&&await m(),n[a.WATCH].active&&!n[a.WATCH].status&&await y(),n[a.PRACTICE].active&&!n[a.PRACTICE].status&&await M(),g.value=o.FINISH},R=()=>{g.value=o.PAUSE,f.value=!0},T=()=>{g.value=o.PROGRESS,f.value=!1};return k("div",void 0,{class:"egg_study_item"},k("button",void 0,{class:D((()=>"egg_study_btn"+(g.value===o.PROGRESS?" loading":""))),type:"button",disabled:C(g,(()=>g.value===o.LOADING||g.value===o.FINISH)),onclick:D((()=>g.value===o.START?j(S,300):g.value===o.PROGRESS?j(R,300):g.value===o.PAUSE?j(T,300):void 0))},L(D((()=>""+(g.value===o.LOADING?"等待中":g.value===o.START?"开始学习":g.value===o.PROGRESS?"正在学习, 点击暂停":g.value===o.PAUSE?"继续学习":g.value===o.FINISH?"已完成":""))))),{async onMounted(){await p(),E((()=>n.map((e=>e.active))),(()=>{if(g.value===o.LOADING||g.value===o.FINISH){if(n.every((e=>!e.active||e.active&&e.status)))return void(g.value=o.FINISH);g.value=o.START}}),!0)}})}function we(){const{taskConfig:e,login:t}=I;return k("div",void 0,{class:"egg_task_list"},e.map((t=>function({title:e,tip:t,checked:a,currentScore:o,dayMaxScore:i,onchange:n,disabled:s}){return k("div",void 0,{class:"egg_task_item"},[k("div",void 0,{class:"egg_label_wrap"},[k("div",void 0,{class:"egg_task_title_wrap"},[k("div",void 0,{class:"egg_task_title"},L(e)),k("div",void 0,{class:"egg_task_progress_wrap"},[k("div",void 0,{class:"egg_task_current"},L(o)),k("div",void 0,{class:"egg_task_max"},L(D((()=>`/${i.value}`))))])]),k("div",void 0,{class:"egg_progress"},[k("div",void 0,{class:"egg_track"},k("div",void 0,{class:"egg_bar",style:D((()=>`width: ${(100*o.value/i.value).toFixed(1)}%;`))}))])]),ne({tip:t,checked:a,disabled:s,onchange:n})])}({title:t.title,tip:t.tip,checked:D((()=>t.active)),disabled:D((()=>t.disabled)),currentScore:D((()=>t.currentScore)),dayMaxScore:D((()=>t.dayMaxScore)),onchange:j((a=>{((t,a,o)=>{const{checked:i}=t.target;e[a].active!==i&&(e[a].active=i,chrome.storage.local.set({taskConfig:JSON.parse(JSON.stringify(e))}),K(`${o} ${i?"打开":"关闭"}`))})(a,t.type,t.title)}),300)}))),{async onMounted(){const{taskConfig:a}=await chrome.storage.local.get("taskConfig");try{e.length===a.length&&e.forEach(((e,t)=>{e.active=a[t].active}))}catch(t){e.forEach((e=>{e.active=!0}))}A((()=>!t.value&&e.forEach((e=>{e.currentScore=0,e.dayMaxScore=0,e.status=!1}))))}})}!function(e,t=document.body){const{ele:a,beforeMount:o,onMounted:i}=e;a&&t&&(o&&o(),t.appendChild(a),i&&i())}(function(){const{tabId:a,login:o,themeColor:i,settings:n,taskConfig:s,maxRead:c,maxWatch:l}=I,r=[{title:"自动开始",tip:"启动时, 自动开始任务, 在倒计时结束前自动开始可随时取消; 如果在自动开始前手动开始任务, 此次自动开始将取消",type:t.AUTO_START},{title:"定时刷新",tip:"定时刷新页面，重新进行任务，此功能需要长时间占用浏览器",type:t.SCHEDULE_RUN},{title:"视频静音",tip:"视听学习时，静音播放视频",type:t.VIDEO_MUTED}],u=[{title:"随机作答",tip:"无答案时, 随机选择或者填入答案, 不保证正确",type:t.RANDOM_EXAM},{title:"自动答题",tip:"进入答题页面时，自动答题并提交答案",type:t.AUTO_ANSWER}],d=[{title:"远程推送",tip:"利用 pushplus 推送, 将登录二维码直接推送到微信公众号",type:t.REMOTE_PUSH}],v=h(!1),g=(e,t,a)=>{const{checked:o}=e.target;n[t]!==o&&(n[t]=o,chrome.storage.local.set({settings:JSON.parse(JSON.stringify(n))}),K(`${a} ${o?"打开":"关闭"}`))},f=async()=>{$("被动断开连接!"),K("已断开连接!"),a.value=0,o.value=!1;(await x()).height.value=700},p=async()=>{const{value:t}=await chrome.cookies.get({url:e.home,name:"token"})||{};t&&(o.value=!0)};return k("div",void 0,{class:"egg_panel",style:D((()=>`--themeColor: ${i.value}`))},[k("div",void 0,{class:"egg_tool_bar_wrap"},[k("div",void 0,{class:"egg_indicator_wrap"},[k("div",void 0,{class:D((()=>"egg_indicator"+(a.value?" active":"")))}),k("div",void 0,{class:"egg_indicator_status"},L(D((()=>a.value?" 已连接":"未连接"))))]),k("div",void 0,{class:"egg_feature_wrap"},[k("button",void 0,{class:"egg_btn",title:"重置",type:"button",onclick:j((async()=>{s.forEach((e=>{!e.disabled&&(e.active=!0)})),n.fill(!1),c.value=80,l.value=100,i.value="#fa3333",await chrome.storage.local.set(JSON.parse(JSON.stringify({settings:n,taskConfig:s,maxRead:c,maxWatch:l,themeColor:i})))}),300)},ae({paths:["M943.8 484.1c-17.5-13.7-42.8-10.7-56.6 6.8-5.7 7.3-8.5 15.8-8.6 24.4h-0.4c-0.6 78.3-26.1 157-78 223.3-124.9 159.2-356 187.1-515.2 62.3-31.7-24.9-58.2-54-79.3-85.9h77.1c22.4 0 40.7-18.3 40.7-40.7v-3c0-22.4-18.3-40.7-40.7-40.7H105.5c-22.4 0-40.7 18.3-40.7 40.7v177.3c0 22.4 18.3 40.7 40.7 40.7h3c22.4 0 40.7-18.3 40.7-40.7v-73.1c24.2 33.3 53 63.1 86 89 47.6 37.3 101 64.2 158.9 79.9 55.9 15.2 113.5 19.3 171.2 12.3 57.7-7 112.7-24.7 163.3-52.8 52.5-29 98-67.9 135.3-115.4 37.3-47.6 64.2-101 79.9-158.9 10.2-37.6 15.4-76 15.6-114.6h-0.1c-0.3-11.6-5.5-23.1-15.5-30.9zM918.7 135.2h-3c-22.4 0-40.7 18.3-40.7 40.7V249c-24.2-33.3-53-63.1-86-89-47.6-37.3-101-64.2-158.9-79.9-55.9-15.2-113.5-19.3-171.2-12.3-57.7 7-112.7 24.7-163.3 52.8-52.5 29-98 67.9-135.3 115.4-37.3 47.5-64.2 101-79.9 158.8-10.2 37.6-15.4 76-15.6 114.6h0.1c0.2 11.7 5.5 23.2 15.4 30.9 17.5 13.7 42.8 10.7 56.6-6.8 5.7-7.3 8.5-15.8 8.6-24.4h0.4c0.6-78.3 26.1-157 78-223.3 124.9-159.2 356-187.1 515.2-62.3 31.7 24.9 58.2 54 79.3 85.9h-77.1c-22.4 0-40.7 18.3-40.7 40.7v3c0 22.4 18.3 40.7 40.7 40.7h177.3c22.4 0 40.7-18.3 40.7-40.7V175.8c0.1-22.3-18.2-40.6-40.6-40.6z"]})),k("button",void 0,{class:"egg_btn",title:"设置",type:"button",onclick:j((()=>{v.value=!0}),300)},ae({paths:["M7.25325 705.466473a503.508932 503.508932 0 0 0 75.26742 121.391295 95.499302 95.499302 0 0 0 93.211173 31.07039 168.59902 168.59902 0 0 1 114.527206 16.257763 148.487566 148.487566 0 0 1 71.052444 83.456515 91.163899 91.163899 0 0 0 75.989987 61.538643 578.053784 578.053784 0 0 0 148.969278 0A91.163899 91.163899 0 0 0 662.380873 957.642436a148.487566 148.487566 0 0 1 72.256723-83.456515 168.59902 168.59902 0 0 1 114.406478-16.257763 95.61973 95.61973 0 0 0 93.331601-31.07039 503.508932 503.508932 0 0 0 75.267419-121.391295 84.29951 84.29951 0 0 0-18.545892-94.897163 138.251197 138.251197 0 0 1 0-197.140426 84.29951 84.29951 0 0 0 18.545892-94.897163 503.508932 503.508932 0 0 0-75.869559-121.391295 95.499302 95.499302 0 0 0-93.211173-31.070391A168.59902 168.59902 0 0 1 734.637596 149.812272a148.848849 148.848849 0 0 1-72.256723-83.456515A91.163899 91.163899 0 0 0 586.631741 4.817115a581.907476 581.907476 0 0 0-148.969277 0A91.163899 91.163899 0 0 0 361.311193 66.355757a148.848849 148.848849 0 0 1-71.413728 83.456515 168.59902 168.59902 0 0 1-114.406478 16.257763 95.378874 95.378874 0 0 0-93.3316 31.070391A503.508932 503.508932 0 0 0 7.25325 318.531721a84.29951 84.29951 0 0 0 18.545893 94.897163 140.057615 140.057615 0 0 1 41.30676 98.509999 140.057615 140.057615 0 0 1-41.30676 98.630427A84.29951 84.29951 0 0 0 7.25325 705.466473z m929.462315-349.240828a219.901294 219.901294 0 0 0 0 312.028615c0.842995 0.842995 2.649413 3.010697 1.806418 5.057971a427.398517 427.398517 0 0 1-63.104205 101.520696 9.513802 9.513802 0 0 1-9.032091 2.167702 255.547944 255.547944 0 0 0-173.777418 24.928569 231.823653 231.823653 0 0 0-111.275354 130.302957 6.984817 6.984817 0 0 1-6.021394 4.937543 492.790851 492.790851 0 0 1-126.328837 0 6.984817 6.984817 0 0 1-6.021394-4.937543 231.823653 231.823653 0 0 0-111.275353-130.302957 255.668372 255.668372 0 0 0-120.427872-30.468252 258.919924 258.919924 0 0 0-52.747408 5.539683 9.513802 9.513802 0 0 1-9.03209-2.167702 427.398517 427.398517 0 0 1-63.104205-101.520696c-0.842995-2.047274 0.963423-4.214976 1.806418-5.057971a221.82814 221.82814 0 0 0 64.910623-156.556233 221.707712 221.707712 0 0 0-65.512762-155.713238c-0.842995-0.842995-2.649413-3.010697-1.806418-5.057971a427.398517 427.398517 0 0 1 63.104205-101.520696 9.393374 9.393374 0 0 1 8.911662-2.167701 255.7888 255.7888 0 0 0 173.897847-24.92857 231.823653 231.823653 0 0 0 111.275353-130.302957 6.984817 6.984817 0 0 1 6.021394-4.937543 492.790851 492.790851 0 0 1 126.328837 0 6.984817 6.984817 0 0 1 6.021394 4.937543 231.823653 231.823653 0 0 0 111.275354 130.302957 255.547944 255.547944 0 0 0 173.777418 24.92857 9.513802 9.513802 0 0 1 9.032091 2.167701 423.063113 423.063113 0 0 1 62.983777 101.520696c0.963423 2.047274-0.842995 4.214976-1.68599 5.057971z","M512.086889 305.766366a206.292944 206.292944 0 1 0 206.172516 206.172517 206.413372 206.413372 0 0 0-206.172516-206.172517z m123.197713 206.172517a123.197713 123.197713 0 1 1-123.197713-123.077285 123.318141 123.318141 0 0 1 123.197713 123.077285z"]}))])]),C((()=>[a.value,o.value]),(()=>a.value&&!o.value?function(){const{login:e,tabId:t}=I,a=h(!1),o=h(""),{addListener:i,removeAllListeners:n}=G();return k("div",void 0,{class:"egg_login_item"},[k("button",void 0,{type:"button",class:"egg_login_btn",onclick:j((()=>{V("login",{type:"tab",id:t.value,data:null})}),300)},L(D((()=>a.value?"刷新二维码":"扫码登录")))),k("div",void 0,{class:D((()=>"egg_login_img_wrap"+(a.value?" active":"")))},k("img",void 0,{class:"egg_login_img",src:o}))],{onMounted(){i("qrcode",(async e=>{(await x()).height.value=810,o.value=e,a.value=!0})),i("qrcodeRevoked",(()=>{V("login",{type:"tab",id:t.value,data:null})})),i("loginSuccess",(async()=>{a.value=!1,o.value="",e.value=!0,(await x()).height.value=700})),i("loginFail",(async()=>{a.value=!1,o.value="",e.value=!1,(await x()).height.value=700}))},beforeDestroy(){n()}})}():void 0)),C((()=>[a.value,o.value]),(()=>a.value&&o.value?function(){const{login:e,tabId:t,isBlack:a}=I,{addListener:o,removeAllListeners:i}=G(),n=h(null);return k("div",void 0,{class:"egg_user_item"},D((()=>n.value?[k("div",void 0,{class:"egg_userinfo"},[k("div",void 0,{class:"egg_avatar"},[D((()=>n.value.avatarMediaUrl?k("img",void 0,{src:n.value.avatarMediaUrl,class:"egg_avatar_img",title:"用户头像",alt:"用户头像"}):k("div",void 0,{class:"egg_avatar_nick",title:"用户头像"},L(n.value.nick.substring(1,3))))),k("div",void 0,{title:`用户状态 (${a.value?"封禁":"正常"})`,class:D((()=>"egg_status"+(a.value?" deactive":" active")))})]),k("div",void 0,{class:"egg_nick",title:"用户昵称"},L(n.value.nick))]),k("button",void 0,{type:"button",class:"egg_logout_btn",onclick:j((()=>{V("logout",{type:"tab",id:t.value,data:null}),e.value=!1}),300)},L("退出"))]:void 0)),{onMounted(){o("getUserInfo",(e=>{e&&(n.value=e)})),V("getUserInfo",{type:"tab",id:t.value,data:null}),A((()=>!e.value&&(n.value=null)))},beforeDestroy(){i()}})}():void 0)),le(),te({text:"任务"}),we(),te({text:"运行"}),k("div",void 0,{class:"egg_run_list"},r.map((e=>se({title:e.title,tip:e.tip,checked:D((()=>n[e.type])),onchange:j((t=>{g(t,e.type,e.title)}),300)})))),te({text:"答题"}),k("div",void 0,{class:"egg_exam_list"},u.map((e=>se({title:e.title,tip:e.tip,checked:D((()=>n[e.type])),onchange:j((t=>{g(t,e.type,e.title)}),300)})))),te({text:"推送"}),k("div",void 0,{class:"egg_push_list"},d.map((e=>se({title:e.title,tip:e.tip,checked:D((()=>n[e.type])),onchange:j((t=>{g(t,e.type,e.title)}),300)})))),C((()=>[a.value,o.value]),(()=>a.value&&o.value?be():void 0)),oe(),de({settingsShow:v,settings:n,themeColor:i}),k("div",void 0,{class:"egg_back_item"},ae({viewBox:"0 0 762 52.917",paths:["M0 0c22.863 0 40.637 25.93 63.5 25.93S104.137 0 127 0s40.637 25.93 63.5 25.93S231.137 0 254 0s40.637 25.93 63.5 25.93S358.137 0 381 0s40.637 25.93 63.5 25.93S485.137 0 508 0s40.637 25.93 63.5 25.93S612.137 0 635 0s40.637 25.93 63.5 25.93S739.137 0 762 0v52.917H0z"]}))],{beforeCreat(){(async()=>{const{settings:e}=await chrome.storage.local.get("settings");try{n.length===e.length&&n.forEach(((t,a)=>n[a]=e[a]))}catch(e){n.forEach(((e,t)=>n[t]=!1))}})(),(()=>{let e=!1,t=-1,o=-1;F("connect",((a,i)=>{i.tab?.id&&(e?V("occupied",{type:"tab",id:i.tab.id,data:null}):(e||(e=!0,o=i.tab.id,t=setTimeout((()=>{e=!1,o=-1}),3e3)),$("正在连接..."),V("connecting",{type:"tab",id:i.tab.id,data:null})))})),F("connected",(async(i,n)=>{if(!n.tab?.id)return;if(n.tab.id!==o)return;clearTimeout(t),o=-1,$("已连接!"),K("已连接!");const{id:s}=n.tab;a.value=s,await chrome.tabs.update(s,{autoDiscardable:!1}),p(),Z(s,(()=>{e=!1,f()}),{once:!0}),F("disconnect",((t,a)=>{a.tab?.id&&s===a.tab.id&&(e=!1,f())}),{once:!0})}))})()}})}(),document.querySelector("#app"));
